{"paragraphs":[{"title":"Importar Librerias","text":"// crear Schema\nimport org.apache.spark.sql.types._\n// crear ID incremental\nimport org.apache.spark.sql.functions._","user":"vgarcia","dateUpdated":"2019-06-07T13:14:54-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._"}]},"apps":[],"jobName":"paragraph_1557324942195_-169011042","id":"20190508-101542_856313757","dateCreated":"2019-05-08T10:15:42-0400","dateStarted":"2019-06-07T13:14:54-0400","dateFinished":"2019-06-07T13:14:55-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:165"},{"title":"Crear Schema","text":"var schema = StructType(Array(\r\n    StructField(\"sepal_length\", DoubleType, true),\r\n    StructField(\"sepal_width\", DoubleType, true),\r\n    StructField(\"petal_length\", DoubleType, true),\r\n    StructField(\"petal_width\", DoubleType, true),\r\n    StructField(\"label\", StringType, true)))","user":"vgarcia","dateUpdated":"2019-06-07T13:15:52-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(sepal_length,DoubleType,true), StructField(sepal_width,DoubleType,true), StructField(petal_length,DoubleType,true), StructField(petal_width,DoubleType,true), StructField(label,StringType,true))"}]},"apps":[],"jobName":"paragraph_1557269255824_-222254192","id":"20190507-184735_1867222645","dateCreated":"2019-05-07T18:47:35-0400","dateStarted":"2019-06-07T13:15:52-0400","dateFinished":"2019-06-07T13:15:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"title":"Importar datos","text":"var dataset = spark.read.format(\"csv\").\r\noption(\"header\", \"true\").\r\noption(\"delimiter\",\";\").\r\nschema(schema).\r\nload(\"/user/vgarcia/R08/iris_v2.csv\").\r\nselect(\"sepal_length\",\"sepal_width\",\"petal_length\",\"petal_width\", \"label\")\r\n\r\n","user":"vgarcia","dateUpdated":"2019-06-07T13:21:57-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dataset: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 3 more fields]"}]},"apps":[],"jobName":"paragraph_1557268054155_-1725220574","id":"20190507-182734_1672848870","dateCreated":"2019-05-07T18:27:34-0400","dateStarted":"2019-06-07T12:38:33-0400","dateFinished":"2019-06-07T12:38:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:167"},{"title":"Conteo de la data importada","text":"dataset.groupBy(\"label\").count().show()","user":"vgarcia","dateUpdated":"2019-06-07T13:21:24-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+-----+\n|          label|count|\n+---------------+-----+\n| Iris-virginica|   50|\n|    Iris-setosa|   50|\n|Iris-versicolor|   50|\n+---------------+-----+"}]},"apps":[],"jobName":"paragraph_1557276987719_-841842359","id":"20190507-205627_1840986787","dateCreated":"2019-05-07T20:56:27-0400","dateStarted":"2019-06-07T13:21:24-0400","dateFinished":"2019-06-07T13:21:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:168"},{"title":"Tipos de datos","text":"dataset.printSchema()","user":"vgarcia","dateUpdated":"2019-06-07T13:21:46-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- sepal_length: double (nullable = true)\n |-- sepal_width: double (nullable = true)\n |-- petal_length: double (nullable = true)\n |-- petal_width: double (nullable = true)\n |-- label: string (nullable = true)"}]},"apps":[],"jobName":"paragraph_1557274271233_-878128444","id":"20190507-201111_724810853","dateCreated":"2019-05-07T20:11:11-0400","dateStarted":"2019-06-07T12:38:40-0400","dateFinished":"2019-06-07T12:38:50-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:169"},{"text":"%md\n# Modelo","user":"vgarcia","dateUpdated":"2019-05-29T18:08:04-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","tableHide":false,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Modelo</h1>\n"}]},"apps":[],"jobName":"paragraph_1557328266027_-271068569","id":"20190508-111106_709487953","dateCreated":"2019-05-08T11:11:06-0400","dateStarted":"2019-05-29T18:08:04-0400","dateFinished":"2019-05-29T18:08:04-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:170"},{"text":"%md\n### VectorAssembler","user":"vgarcia","dateUpdated":"2019-05-29T18:08:04-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>VectorAssembler</h3>\n"}]},"apps":[],"jobName":"paragraph_1557269364824_-526044204","id":"20190507-184924_397365419","dateCreated":"2019-05-07T18:49:24-0400","dateStarted":"2019-05-29T18:08:04-0400","dateFinished":"2019-05-29T18:08:04-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171"},{"title":"Importar librerías","text":"import org.apache.spark.ml.feature.VectorAssembler\r\nimport org.apache.spark.ml.linalg.Vectors","user":"vgarcia","dateUpdated":"2019-06-07T13:23:02-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Vectors"}]},"apps":[],"jobName":"paragraph_1557269364978_346599690","id":"20190507-184924_1068271574","dateCreated":"2019-05-07T18:49:24-0400","dateStarted":"2019-06-07T13:23:02-0400","dateFinished":"2019-06-07T13:23:03-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172"},{"title":"Seleccionar variables para el vector assembler","text":"val assembler = new VectorAssembler().\nsetInputCols(Array(\"sepal_length\", \"sepal_width\", \"petal_length\", \"petal_width\")).\nsetOutputCol(\"features\")\n\nval output = assembler.transform(dataset)","user":"vgarcia","dateUpdated":"2019-06-07T13:23:05-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_63f269583e3d\noutput: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 4 more fields]"}]},"apps":[],"jobName":"paragraph_1557273942359_1689476333","id":"20190507-200542_1148179096","dateCreated":"2019-05-07T20:05:42-0400","dateStarted":"2019-06-07T13:23:05-0400","dateFinished":"2019-06-07T13:23:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173"},{"title":"validar resultados vector assembler","text":"output.show(2)","user":"vgarcia","dateUpdated":"2019-06-07T13:23:54-0400","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+------------+-----------+-----------+-----------------+\n|sepal_length|sepal_width|petal_length|petal_width|      label|         features|\n+------------+-----------+------------+-----------+-----------+-----------------+\n|         5.1|        3.5|         1.4|        0.2|Iris-setosa|[5.1,3.5,1.4,0.2]|\n|         4.9|        3.0|         1.4|        0.2|Iris-setosa|[4.9,3.0,1.4,0.2]|\n+------------+-----------+------------+-----------+-----------+-----------------+\nonly showing top 2 rows"}]},"apps":[],"jobName":"paragraph_1557269365400_-1630733449","id":"20190507-184925_1322874371","dateCreated":"2019-05-07T18:49:25-0400","dateStarted":"2019-06-07T13:23:54-0400","dateFinished":"2019-06-07T13:24:02-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174"},{"text":"%md\n### Basic Statistics","user":"vgarcia","dateUpdated":"2019-06-07T12:37:16-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Basic Statistics</h3>\n"}]},"apps":[],"jobName":"paragraph_1559160679668_637746701","id":"20190529-161119_312313837","dateCreated":"2019-05-29T16:11:19-0400","dateStarted":"2019-06-07T12:37:16-0400","dateFinished":"2019-06-07T12:37:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175"},{"text":"output.\nselect(\"sepal_length\",\"sepal_width\",\"petal_length\",\"petal_width\").\ndescribe().show()","user":"vgarcia","dateUpdated":"2019-06-07T13:25:44-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+-------------------+------------------+------------------+\n|summary|      sepal_length|        sepal_width|      petal_length|       petal_width|\n+-------+------------------+-------------------+------------------+------------------+\n|  count|               150|                150|               150|               150|\n|   mean| 5.843333333333335| 3.0540000000000007|3.7586666666666693|1.1986666666666672|\n| stddev|0.8280661279778637|0.43359431136217375| 1.764420419952262|0.7631607417008414|\n|    min|               4.3|                2.0|               1.0|               0.1|\n|    max|               7.9|                4.4|               6.9|               2.5|\n+-------+------------------+-------------------+------------------+------------------+"}]},"apps":[],"jobName":"paragraph_1559160679433_-642960363","id":"20190529-161119_1547275990","dateCreated":"2019-05-29T16:11:19-0400","dateStarted":"2019-06-07T13:25:44-0400","dateFinished":"2019-06-07T13:25:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176"},{"title":"Percentiles","text":"output.stat.approxQuantile(\"sepal_length\",Array(0.25,0.5,0.75),0.0)\noutput.stat.approxQuantile(\"sepal_width\",Array(0.25,0.5,0.75),0.0)\noutput.stat.approxQuantile(\"petal_length\",Array(0.25,0.5,0.75),0.0)\noutput.stat.approxQuantile(\"petal_width\",Array(0.25,0.5,0.75),0.0)","user":"vgarcia","dateUpdated":"2019-06-07T13:25:50-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res19: Array[Double] = Array(5.1, 5.8, 6.4)\nres20: Array[Double] = Array(2.8, 3.0, 3.3)\nres21: Array[Double] = Array(1.6, 4.3, 5.1)\nres22: Array[Double] = Array(0.3, 1.3, 1.8)"}]},"apps":[],"jobName":"paragraph_1559160679227_1225488671","id":"20190529-161119_1899520719","dateCreated":"2019-05-29T16:11:19-0400","dateStarted":"2019-06-07T13:25:50-0400","dateFinished":"2019-06-07T13:25:55-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:177"},{"text":"%md\n## Correlation","user":"vgarcia","dateUpdated":"2019-06-07T12:41:51-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Correlation</h2>\n"}]},"apps":[],"jobName":"paragraph_1559160851537_147562828","id":"20190529-161411_1436447607","dateCreated":"2019-05-29T16:14:11-0400","dateStarted":"2019-06-07T12:41:51-0400","dateFinished":"2019-06-07T12:41:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:178"},{"title":"Importar librerías","text":"import org.apache.spark.ml.linalg.{Matrix, Vectors}\r\nimport org.apache.spark.ml.stat.Correlation\r\nimport org.apache.spark.sql.Row","user":"vgarcia","dateUpdated":"2019-06-07T12:41:23-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.linalg.{Matrix, Vectors}\nimport org.apache.spark.ml.stat.Correlation\nimport org.apache.spark.sql.Row"}]},"apps":[],"jobName":"paragraph_1559160851376_-1557827138","id":"20190529-161411_1748586183","dateCreated":"2019-05-29T16:14:11-0400","dateStarted":"2019-06-07T12:41:23-0400","dateFinished":"2019-06-07T12:41:24-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179"},{"title":"Pearson correlation matrix","text":"println(s\"Pearson correlation matrix\")\r\nval Row(coeff1: Matrix) = Correlation.corr(output.select(\"features\"), \"features\").head\r\n//println(s\"Pearson correlation matrix:\\n $coeff1\")","user":"vgarcia","dateUpdated":"2019-06-07T12:42:28-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Pearson correlation matrix\ncoeff1: org.apache.spark.ml.linalg.Matrix =\n1.0                   -0.10936924995062468  0.8717541573048866    0.8179536333691776\n-0.10936924995062468  1.0                   -0.42051609640115817  -0.35654408961379946\n0.8717541573048866    -0.42051609640115817  1.0                   0.9627570970509658\n0.8179536333691776    -0.35654408961379946  0.9627570970509658    1.0"}]},"apps":[],"jobName":"paragraph_1559160851113_504993287","id":"20190529-161411_1367165315","dateCreated":"2019-05-29T16:14:11-0400","dateStarted":"2019-05-29T18:22:33-0400","dateFinished":"2019-05-29T18:22:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180"},{"title":"Spearman correlation matrix","text":"println(s\"Spearman correlation matrix:\")\r\nval Row(coeff2: Matrix) = Correlation.corr(output.select(\"features\"), \"features\", \"spearman\").head\r\n//println(s\"Spearman correlation matrix:\\n $coeff2\")","user":"vgarcia","dateUpdated":"2019-05-29T18:08:17-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spearman correlation matrix:\ncoeff2: org.apache.spark.ml.linalg.Matrix =\n1.0                   -0.22920531201542474  0.848454727484635     0.8204105173543711\n-0.22920531201542474  1.0                   -0.43065679517164585  -0.4145078405973346\n0.848454727484635     -0.43065679517164585  1.0                   0.9293554774071608\n0.8204105173543711    -0.4145078405973346   0.9293554774071608    1.0"}]},"apps":[],"jobName":"paragraph_1559160850785_2078091314","id":"20190529-161410_1129328263","dateCreated":"2019-05-29T16:14:10-0400","dateStarted":"2019-05-29T18:08:18-0400","dateFinished":"2019-05-29T18:08:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:181"},{"text":"%md\n## MinMaxScaler","user":"vgarcia","dateUpdated":"2019-06-07T12:43:56-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>MinMaxScaler</h2>\n"}]},"apps":[],"jobName":"paragraph_1559160678932_1241290434","id":"20190529-161118_925489411","dateCreated":"2019-05-29T16:11:18-0400","dateStarted":"2019-06-07T12:43:56-0400","dateFinished":"2019-06-07T12:43:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:182"},{"title":"Importar librerias","text":"import org.apache.spark.ml.feature.MinMaxScaler\r\nimport org.apache.spark.ml.linalg.Vectors","user":"vgarcia","dateUpdated":"2019-06-07T13:55:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.MinMaxScaler\nimport org.apache.spark.ml.linalg.Vectors"}]},"apps":[],"jobName":"paragraph_1559160678675_1185115596","id":"20190529-161118_812276068","dateCreated":"2019-05-29T16:11:18-0400","dateStarted":"2019-06-07T13:29:35-0400","dateFinished":"2019-06-07T13:29:36-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:183"},{"title":"MinMaxScaler","text":"val df_tmp = output\r\n\r\nval scaler = new MinMaxScaler().setInputCol(\"features\").setOutputCol(\"MinMaxScalerFeatures\")\r\n\r\n// Compute summary statistics and generate MinMaxScalerModel\r\nval scalerModel = scaler.fit(df_tmp)\r\n\r\n// rescale each feature to range [min, max].\r\nval scaledData = scalerModel.transform(df_tmp)\r\nprintln(s\"Features scaled to range: [${scaler.getMin}, ${scaler.getMax}]\")\r\nscaledData.count()\r\nscaledData.select(\"features\", \"MinMaxScalerFeatures\").show(5,false)","user":"vgarcia","dateUpdated":"2019-06-07T13:33:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_tmp: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 4 more fields]\nscaler: org.apache.spark.ml.feature.MinMaxScaler = minMaxScal_f039e0d4b7d8\nscalerModel: org.apache.spark.ml.feature.MinMaxScalerModel = minMaxScal_f039e0d4b7d8\nscaledData: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 5 more fields]\nFeatures scaled to range: [0.0, 1.0]\nres37: Long = 150\n+-----------------+--------------------------------------------------------------------------------+\n|features         |MinMaxScalerFeatures                                                            |\n+-----------------+--------------------------------------------------------------------------------+\n|[5.1,3.5,1.4,0.2]|[0.22222222222222213,0.6249999999999999,0.06779661016949151,0.04166666666666667]|\n|[4.9,3.0,1.4,0.2]|[0.1666666666666668,0.41666666666666663,0.06779661016949151,0.04166666666666667]|\n|[4.7,3.2,1.3,0.2]|[0.11111111111111119,0.5,0.05084745762711865,0.04166666666666667]               |\n|[4.6,3.1,1.5,0.2]|[0.08333333333333327,0.4583333333333333,0.0847457627118644,0.04166666666666667] |\n|[5.0,3.6,1.4,0.2]|[0.19444444444444448,0.6666666666666666,0.06779661016949151,0.04166666666666667]|\n+-----------------+--------------------------------------------------------------------------------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1559161072882_-2081405205","id":"20190529-161752_1713582774","dateCreated":"2019-05-29T16:17:52-0400","dateStarted":"2019-06-07T13:33:18-0400","dateFinished":"2019-06-07T13:33:29-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:184"},{"text":"%md\n## StandardScaler","user":"vgarcia","dateUpdated":"2019-06-07T12:47:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>StandardScaler</h2>\n"}]},"apps":[],"jobName":"paragraph_1559161072748_1835643885","id":"20190529-161752_1589213807","dateCreated":"2019-05-29T16:17:52-0400","dateStarted":"2019-06-07T12:47:58-0400","dateFinished":"2019-06-07T12:47:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:185"},{"title":"Importar librerías","text":"import org.apache.spark.ml.feature.StandardScaler","user":"vgarcia","dateUpdated":"2019-06-07T13:34:09-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.StandardScaler"}]},"apps":[],"jobName":"paragraph_1559161072611_1737698291","id":"20190529-161752_65824916","dateCreated":"2019-05-29T16:17:52-0400","dateStarted":"2019-06-07T13:34:09-0400","dateFinished":"2019-06-07T13:34:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186"},{"title":"Método StandardScaler","text":"//val dataFrame = spark.read.format(\"libsvm\").load(\"data/mllib/sample_libsvm_data.txt\")\r\nval df_tmp = scaledData\r\n\r\nval scaler = new StandardScaler().setInputCol(\"MinMaxScalerFeatures\").setOutputCol(\"StandardScalerFeatures\").setWithStd(true).setWithMean(false)\r\n\r\n// Compute summary statistics by fitting the StandardScaler.\r\nval scalerModel = scaler.fit(df_tmp)\r\n\r\n// Normalize each feature to have unit standard deviation.\r\nval scaledData = scalerModel.transform(df_tmp)\r\nscaledData.count()\r\nscaledData.select(\"features\", \"MinMaxScalerFeatures\",\"StandardScalerFeatures\").show(5, false)","user":"vgarcia","dateUpdated":"2019-06-07T13:36:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_tmp: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 5 more fields]\nscaler: org.apache.spark.ml.feature.StandardScaler = stdScal_91cd543651fc\nscalerModel: org.apache.spark.ml.feature.StandardScalerModel = stdScal_91cd543651fc\nscaledData: org.apache.spark.sql.DataFrame = [sepal_length: double, sepal_width: double ... 6 more fields]\nres47: Long = 150\n+-----------------+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------+\n|features         |MinMaxScalerFeatures                                                            |StandardScalerFeatures                                                         |\n+-----------------+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------+\n|[5.1,3.5,1.4,0.2]|[0.22222222222222213,0.6249999999999999,0.06779661016949151,0.04166666666666667]|[0.9661064170727516,3.459454980596082,0.22670333865826722,0.13103399393571005] |\n|[4.9,3.0,1.4,0.2]|[0.1666666666666668,0.41666666666666663,0.06779661016949151,0.04166666666666667]|[0.7245798128045645,2.3063033203973884,0.22670333865826722,0.13103399393571005]|\n|[4.7,3.2,1.3,0.2]|[0.11111111111111119,0.5,0.05084745762711865,0.04166666666666667]               |[0.4830532085363763,2.7675639844768662,0.17002750399370045,0.13103399393571005]|\n|[4.6,3.1,1.5,0.2]|[0.08333333333333327,0.4583333333333333,0.0847457627118644,0.04166666666666667] |[0.3622899064022817,2.5369336524371273,0.2833791733228341,0.13103399393571005] |\n|[5.0,3.6,1.4,0.2]|[0.19444444444444448,0.6666666666666666,0.06779661016949151,0.04166666666666667]|[0.8453431149386581,3.6900853126358215,0.22670333865826722,0.13103399393571005]|\n+-----------------+--------------------------------------------------------------------------------+-------------------------------------------------------------------------------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1559161072479_291609139","id":"20190529-161752_1045431366","dateCreated":"2019-05-29T16:17:52-0400","dateStarted":"2019-06-07T13:36:18-0400","dateFinished":"2019-06-07T13:36:30-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:187"},{"text":"scaledData.show(5)","user":"vgarcia","dateUpdated":"2019-06-07T13:57:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+------------+-----------+-----------+-----------------+--------------------+----------------------+\n|sepal_length|sepal_width|petal_length|petal_width|      label|         features|MinMaxScalerFeatures|StandardScalerFeatures|\n+------------+-----------+------------+-----------+-----------+-----------------+--------------------+----------------------+\n|         5.1|        3.5|         1.4|        0.2|Iris-setosa|[5.1,3.5,1.4,0.2]|[0.22222222222222...|  [0.96610641707275...|\n|         4.9|        3.0|         1.4|        0.2|Iris-setosa|[4.9,3.0,1.4,0.2]|[0.16666666666666...|  [0.72457981280456...|\n|         4.7|        3.2|         1.3|        0.2|Iris-setosa|[4.7,3.2,1.3,0.2]|[0.11111111111111...|  [0.48305320853637...|\n|         4.6|        3.1|         1.5|        0.2|Iris-setosa|[4.6,3.1,1.5,0.2]|[0.08333333333333...|  [0.36228990640228...|\n|         5.0|        3.6|         1.4|        0.2|Iris-setosa|[5.0,3.6,1.4,0.2]|[0.19444444444444...|  [0.84534311493865...|\n+------------+-----------+------------+-----------+-----------+-----------------+--------------------+----------------------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1559160678478_-2067846134","id":"20190529-161118_930955720","dateCreated":"2019-05-29T16:11:18-0400","dateStarted":"2019-06-07T13:45:22-0400","dateFinished":"2019-06-07T13:45:30-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:188","title":"Visualizar dataFrame final"},{"text":"%md\n## K-means","user":"vgarcia","dateUpdated":"2019-05-29T18:08:31-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>K-means</h2>\n"}]},"apps":[],"jobName":"paragraph_1557264678103_-492207761","id":"20190507-165706_1503391696","dateCreated":"2019-05-07T17:31:18-0400","dateStarted":"2019-05-29T18:08:31-0400","dateFinished":"2019-05-29T18:08:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:189"},{"text":"import org.apache.spark.ml.clustering.KMeans\r\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator","user":"vgarcia","dateUpdated":"2019-06-07T13:50:07-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.clustering.KMeans\nimport org.apache.spark.ml.evaluation.ClusteringEvaluator"}]},"apps":[],"jobName":"paragraph_1557275226482_1664798111","id":"20190507-202706_1707397329","dateCreated":"2019-05-07T20:27:06-0400","dateStarted":"2019-06-07T13:50:08-0400","dateFinished":"2019-06-07T13:50:09-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:190","title":"Importar librerias"},{"text":"// Loads data.\nval data = scaledData.select(\"StandardScalerFeatures\",\"label\").withColumnRenamed(\"StandardScalerFeatures\",\"features\")\ndata.printSchema()\ndata.count()\ndata.show(2,false)","user":"vgarcia","dateUpdated":"2019-06-07T13:49:43-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data: org.apache.spark.sql.DataFrame = [features: vector, label: string]\nroot\n |-- features: vector (nullable = true)\n |-- label: string (nullable = true)\n\nres56: Long = 150\n+-------------------------------------------------------------------------------+-----------+\n|features                                                                       |label      |\n+-------------------------------------------------------------------------------+-----------+\n|[0.9661064170727516,3.459454980596082,0.22670333865826722,0.13103399393571005] |Iris-setosa|\n|[0.7245798128045645,2.3063033203973884,0.22670333865826722,0.13103399393571005]|Iris-setosa|\n+-------------------------------------------------------------------------------+-----------+\nonly showing top 2 rows"}]},"apps":[],"jobName":"paragraph_1557275226654_-330235929","id":"20190507-202706_1221490902","dateCreated":"2019-05-07T20:27:06-0400","dateStarted":"2019-06-07T13:49:43-0400","dateFinished":"2019-06-07T13:49:52-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:191","title":"Seleccionar data de entrada"},{"title":"Clustering k = 3","text":"// Trains a k-means model.\r\nval kmeans = new KMeans().setK(3).setSeed(103L)\r\nval model = kmeans.fit(data)\r\n\r\n// Make predictions\r\nval predictions = model.transform(data)\r\n\r\n// Evaluate clustering by computing Silhouette score\r\nval evaluator = new ClusteringEvaluator()\r\n\r\nprintln(\"######################################################################\")\r\nval silhouette = evaluator.evaluate(predictions)\r\nprintln(s\"Silhouette with squared euclidean distance = $silhouette\")\r\nprintln(\"######################################################################\")\r\n// Shows the result.\r\nprintln(\"Cluster Centers: \")\r\nmodel.clusterCenters.foreach(println)\r\nprintln(\"######################################################################\")\r\npredictions.groupBy(\"prediction\").count().show\r\nprintln(\"######################################################################\")\r\npredictions.show(5)","user":"vgarcia","dateUpdated":"2019-06-07T13:50:27-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"kmeans: org.apache.spark.ml.clustering.KMeans = kmeans_84192f933d92\nmodel: org.apache.spark.ml.clustering.KMeansModel = kmeans_84192f933d92\npredictions: org.apache.spark.sql.DataFrame = [features: vector, label: string ... 1 more field]\nevaluator: org.apache.spark.ml.evaluation.ClusteringEvaluator = cluEval_0851270c16ac\n######################################################################\nsilhouette: Double = 0.653587550120595\nSilhouette with squared euclidean distance = 0.653587550120595\n######################################################################\nCluster Centers: \n[1.8524227952354766,1.5608731400546614,1.9391232003091075,1.7502397761412691]\n[0.8525889130667034,3.2703381083234975,0.2629758728435899,0.1886889512674225]\n[3.0273164148614913,2.584108038536165,2.5632934314201807,2.465821522244725]\n######################################################################\n+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1|   50|\n|         2|   44|\n|         0|   56|\n+----------+-----+\n\n######################################################################\n+--------------------+-----------+----------+\n|            features|      label|prediction|\n+--------------------+-----------+----------+\n|[0.96610641707275...|Iris-setosa|         1|\n|[0.72457981280456...|Iris-setosa|         1|\n|[0.48305320853637...|Iris-setosa|         1|\n|[0.36228990640228...|Iris-setosa|         1|\n|[0.84534311493865...|Iris-setosa|         1|\n+--------------------+-----------+----------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1557277122427_799740239","id":"20190507-205842_1605581808","dateCreated":"2019-05-07T20:58:42-0400","dateStarted":"2019-06-07T13:50:11-0400","dateFinished":"2019-06-07T13:50:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:192"},{"text":"predictions.groupBy(\"label\",\"prediction\").count.show\npredictions.show(5,false)","user":"vgarcia","dateUpdated":"2019-06-07T13:51:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+----------+-----+\n|          label|prediction|count|\n+---------------+----------+-----+\n|    Iris-setosa|         1|   50|\n|Iris-versicolor|         2|   11|\n|Iris-versicolor|         0|   39|\n| Iris-virginica|         0|   17|\n| Iris-virginica|         2|   33|\n+---------------+----------+-----+\n\n+-------------------------------------------------------------------------------+-----------+----------+\n|features                                                                       |label      |prediction|\n+-------------------------------------------------------------------------------+-----------+----------+\n|[0.9661064170727516,3.459454980596082,0.22670333865826722,0.13103399393571005] |Iris-setosa|1         |\n|[0.7245798128045645,2.3063033203973884,0.22670333865826722,0.13103399393571005]|Iris-setosa|1         |\n|[0.4830532085363763,2.7675639844768662,0.17002750399370045,0.13103399393571005]|Iris-setosa|1         |\n|[0.3622899064022817,2.5369336524371273,0.2833791733228341,0.13103399393571005] |Iris-setosa|1         |\n|[0.8453431149386581,3.6900853126358215,0.22670333865826722,0.13103399393571005]|Iris-setosa|1         |\n+-------------------------------------------------------------------------------+-----------+----------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1557275227616_-1221728113","id":"20190507-202707_2069389277","dateCreated":"2019-05-07T20:27:07-0400","dateStarted":"2019-06-07T13:51:58-0400","dateFinished":"2019-06-07T13:52:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:193","title":"Validar grupos resultantes"},{"user":"vgarcia","dateUpdated":"2019-05-29T18:08:42-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557275227137_418550525","id":"20190507-202707_856453397","dateCreated":"2019-05-07T20:27:07-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:194"},{"user":"vgarcia","dateUpdated":"2019-05-29T18:08:42-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557264678104_533584241","id":"20190507-165706_1997084363","dateCreated":"2019-05-07T17:31:18-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:195"},{"user":"vgarcia","dateUpdated":"2019-05-29T18:08:42-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557264678104_-114124534","id":"20190507-165706_1003670324","dateCreated":"2019-05-07T17:31:18-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:196"},{"user":"vgarcia","dateUpdated":"2019-05-29T18:08:42-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1557264678105_1563394936","id":"20190507-165706_190172824","dateCreated":"2019-05-07T17:31:18-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197"}],"name":"vgarcial/Scala cluster generico (FINAL)","id":"2EC93E4AP","noteParams":{},"noteForms":{},"angularObjects":{"big_livy:shared_process":[],"md:shared_process":[],"angular:shared_process":[],"livy2:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}